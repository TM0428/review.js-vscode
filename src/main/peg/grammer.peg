start
    = _ chapter* _
    ;

chapter
    = headline text:content?
    ;

headline
    = level:"="+ ("[" tag:[^\n\]]+ "]")? ("{" label:[^\n}]+ "}")? space* caption:lineRestString
    ;

lineRestString
    = [^\n]* "\n"?
    ;

content
    = text:((!(newline "=") .) / singlelineComment)*
    ;

singlelineComment
    = "#@" ( !"\n" !"\r" .)* ("\r" / "\r\n" / "\n")
    ;

newline
    = "\r\n"
    / "\n"
    ;

_
    = space*
    ;

space
    = [ \t\r\n]
    ;
